<!-- Назначение файла: краткие правила использования Codex. -->

# Инструкции для Codex

- Всю документацию и комментарии пишите на русском языке.
- Отвечайте пользователям тоже исключительно по‑русски.
- Код должен быть лаконичным и понятным, без избыточности.
- В начале каждого файла указывайте его назначение и основные модули.
- Описывайте назначение всех функций и модулей.

## Тесты

Перед коммитом запускайте скрипт:

```bash
./scripts/setup_and_test.sh
```
Он создаёт `.env`, устанавливает зависимости и выполняет тесты и линтеры.

Если нет файла `.env`, создайте его командой `./scripts/create_env_from_exports.sh` на основе `.env.example`. Локальный `.env` не добавляйте в репозиторий.
Также запускайте `docker compose config` при наличии `docker-compose.yml`.
CI в GitHub Actions тоже вызывает `scripts/setup_and_test.sh`, поэтому
локальная проверка должна проходить теми же командами.

## Документация

При любом изменении обновляйте файлы `README.md`, `CHANGELOG.md`, `ROADMAP.md` и `AGENTS.md`.
Каталог `bot` содержит актуальный код сервера и веб‑интерфейса. `.env.example` теперь использует строку подключения `mongodb://admin:admin@localhost:27017/agrmcs?authSource=admin`.
README включает раздел о GitHub Actions и необходимости отдельного MongoDB-хоста или Railway CLI.
Добавлена рекомендация запускать `npm --prefix bot run check:mongo` для проверки доступности базы.
Скрипт пытается переподключиться с `authSource=admin`, если получена ошибка аутентификации.
Добавлен раздел о подготовке TDWeb и запуске `scripts/setup_tdweb.sh` перед сборкой клиента.

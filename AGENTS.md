<!-- Назначение файла: правила использования Codex. -->

# Инструкции для Codex

## Стиль

- Все комментарии и документацию пишите на русском языке.
- При общении с пользователями отвечайте исключительно на русском.
- Код должен быть лаконичным и эффективным, избегайте избыточности.
- В начале каждого файла размещайте краткое описание его назначения и основных модулей.
- В комментариях описывайте назначение всех модулей и функций.
- При необходимости ищите в интернете актуальные лучшие решения.


Каталог `bot` включает код сервера и мини‑приложения. Каталог `bot_old` сохранён для истории.


## Тесты

Проект включает автотесты на Jest. Перед коммитом запускайте `npm test --prefix bot` и убеждайтесь, что все проверки проходят. Дополнительно выполняйте `npx eslint bot/src` для проверки кода. Если появляется сообщение `Cannot find module '@eslint/js'`, выполните `npm --prefix bot install`.
Также проверяйте фронтенд: `npm run lint --prefix bot/web`.
Перед запуском линтера установите зависимости фронтенда командой
`npm --prefix bot/web install`.
При появлении предупреждений React Hooks обязательно добавляйте недостающие зависимости useEffect.

## Проверка Docker Compose

Если присутствует `docker-compose.yml`, перед коммитом можно выполнить:

```bash
docker compose config
```

Эта команда проверит корректность файла.
Перед запуском убедитесь, что создан `.env`, иначе появится ошибка о его отсутствии.
При необходимости сформируйте `.env` из экспортированных переменных скриптом
`./scripts/create_env_from_exports.sh`. Скрипт создаёт файл только если его нет,
используя значения из текущего окружения либо данные из `.env.example`.
Всегда запускайте этот скрипт при отсутствии `.env`.
В README в разделе «Установка» присутствует напоминание о его запуске.
- Файл `.env` удалён из репозитория; создавайте его локально из `.env.example`.
- В `.dockerignore` добавлены `.env` и `.env.*`, чтобы переменные не попадали в контекст Docker.

- Все переменные окружения используются через модуль `bot/src/config.js`.
- В этом модуле проверяйте, что `MONGO_DATABASE_URL` начинается с
  `mongodb://` или `mongodb+srv://`, иначе приложение не подключится к базе.
- При ошибке `502` на `/bot` не удаётся подключиться к MongoDB. Проверьте доступность DNS кластера и корректность `MONGO_DATABASE_URL`. Бот выполнит три попытки переподключения.
- В Railway можно добавить плагин MongoDB; URL вставьте в `MONGO_DATABASE_URL`.
- `APP_URL` должен быть HTTPS, иначе Telegram отвергнет Web App ссылку.
- Для запуска тестов также задавайте `APP_URL`, иначе Jest завершится ошибкой.
- При указании `WEBHOOK_URL` бот запускается в режиме webhook и регистрирует URL через `setWebhook`.

## Деплой

Перед развёртыванием убедитесь, что статический фронтенд собран командой
`npm --prefix bot run build-client` или через `Procfile`.
- Vite сохраняет сборку напрямую в каталог `bot/public` (параметр `build.outDir: '../public'`).

- Фронтенд теперь расположен в каталоге `bot/web`, Dockerfile и скрипты используют его вместо устаревшего `bot/client`.
- Основной образ собирается через `bot/Dockerfile`; корневой `Dockerfile` служит для единой сборки.
- Перед сборкой установите зависимости фронтенда: `npm --prefix bot/web install`
- Если в логах появляется `GET /dashboard/` со статусом `404`, пересоберите фронтенд `npm --prefix bot run build-client` и убедитесь в наличии fallback `app.get('/{*splat}')` в API.
- Для fallback добавлен rate limiter, чтобы исключить перегрузку сервера.
- Маршрут `/api/tasks/:id` тоже ограничен rate limiter (100 запросов за 15 минут).
- Путь `/api/auth/login` принимает не более 5 запросов в минуту.
- Аналогичный лимит введён для `/api/groups`, `/api/users`, `/api/roles`, `/api/logs`
  и `/api/tasks/:id/status`.
- При пустой директории `bot/public` сервер сам выполнит `npm run build-client`, Docker автоматически запускает эту команду, однако после обновлений фронтенда сборку лучше запускать вручную.
- После обновления зависимостей повторяйте `npm --prefix bot/web install` и затем `npm --prefix bot run build-client`.
- Для сборки Tailwind используйте плагин `@tailwindcss/postcss` в файле `postcss.config.js`.
- Конфигурация Tailwind должна соответствовать шаблону TailAdmin 1.3 и содержать шрифты Inter, Poppins и Roboto.
- Для форматирования кода фронтенда запустите `npm --prefix bot/web run format`.
  - Для поиска ошибок сохраняйте вывод в лог:
  ```bash
  npm --prefix bot/web install > /tmp/npm_install.log 2>&1 && tail -n 20 /tmp/npm_install.log
  npm --prefix bot run build-client > /tmp/npm_build.log 2>&1 && tail -n 20 /tmp/npm_build.log
  # или используйте ./scripts/build_client.sh
  ```
  Перед запуском `docker compose build` убедитесь, что запущен Docker daemon,
  иначе появится сообщение `Cannot connect to the Docker daemon`.

## Документация

- При добавлении функционала обновляйте раздел «В разработке» в `ROADMAP.md`.
- При любом изменении синхронно обновляйте `README.md`, `CHANGELOG.md`, `ROADMAP.md` и `AGENTS.md`.
- Создавайте задачи через шаблоны в `.github/ISSUE_TEMPLATE` и придерживайтесь `CONTRIBUTING.md`.
- Добавлен шаблон `task.yml` с полями локации, срока, статуса и ответственных.
- Поддерживайте раздел «Обзор текущего состояния» в `README.md`, фиксируя основные плюсы и недостатки проекта.
- В README добавлена секция «Лучшие практики CI/CD», обновляйте её по мере развития.
- При добавлении маршрутов используйте `helmet`, `cors` и валидацию через `express-validator`.
- `/auth/register` и `/auth/login` проверяют входные данные через `express-validator`.
- Страница `/dashboard/tasks` должна получать данные из MongoDB через API.
- Для неё создан компонент `TasksPage` с чеклистом и таймтрекером, API находится по пути `/api/tasks`.
- На этой странице должна быть форма создания новой задачи.
- При успешном создании задачи добавляйте уведомление через контекст `Toast`, который использует `NotificationBar`.
- Уведомление содержит иконку, кнопку закрытия и исчезает через три секунды.
- Используйте файл `docs/telegram_bot_manual.md` как руководство по настройке команд и вебхуков Telegram-бота.
- Для быстрого обновления меню можно запустить `scripts/set_bot_commands.sh`, файл `scripts/bot_commands.json` содержит пример команд.
- В `scripts/bot_commands.json` теперь перечислен полный набор действий,
  запуск `scripts/set_bot_commands.sh` обновит меню Telegram.
- Для установки описания и списка команд предусмотрен скрипт `scripts/set_bot_messages.sh`, данные берутся из `scripts/bot_messages.json`.
- Для расширенных вызовов Telegram применяйте модуль `bot/src/services/telegramApi.js`.
- Бот регистрирует пользователей через `/start` и поддерживает команды `/list_users` и `/add_user` для админов.
- При создании пользователя бот формирует email как `<telegram_id>@telegram.local`,
- Для проверки текущего URL кнопки меню используйте скрипт `scripts/get_menu_button_url.js`.
  что позволяет избежать ошибки дублирования в MongoDB.
- Для смены ссылки применяйте `scripts/set_menu_button_url.js`.
- Attachment Menu обновляется скриптом `scripts/set_attachment_menu_url.js`, страница выбора задач расположена по пути `/menu`.
- В `docs/telegram_bot_manual.md` приведён пример вывода этого скрипта при отсутствующих токенах.
- Руководство дополнено описанием работы с BotFather и примером запроса `getMyCommands`.
- Для компонентов страницы `tasks` используйте путь `../../_components/Section/*`.
- Новые разделы интерфейса: "Проекты", "Отчёты", "Админ" и "Профиль".
- Добавлена страница "Канбан" по пути `/tasks/kanban` для управления задачами.
- Для drag&drop используется `@hello-pangea/dnd`, совместимая с React 19.
- Страница `/tasks` оформлена в стиле TailAdmin `task-list` с фильтрами по статусу и модальным созданием задач.
- Кнопка создания называется «Новая задача». Старт и финал выбираются через кнопку «Карта» с мини‑Google Maps. Пользователь копирует ссылку «Поделиться» и вставляет её в поле без предварительной проверки. Адрес извлекается при подтверждении и сохраняется вместе с задачей. Форма также предлагает выбор типа и возможность тегать пользователей через `@id`.
- В модальном окне карты показана подсказка о кнопке «Поделиться», ссылка проверяется только при подтверждении и при ошибке выводится сообщение.
- Форма пополнилась полями приоритета, автора, списка исполнителей и комментария с поддержкой упоминаний групп и ролей.
- Для проверки ссылок используется утилита `validateURL` на базе пакета `validator`.
- По клику на название задачи открывается модальное окно с полным описанием и возможностью редактирования.
- Мини‑карта загружается через `maps/embed`, поэтому Google не запрещает фрейм. В API разрешён `frame-src` для `https://www.google.com` и `https://oauth.telegram.org`.

- Для входа и регистрации добавлены страницы `/login` и `/register`; профиль загружается с `/profile`.
- Логика аутентификации реализована через `AuthContext` с методами `login` и `register`.
- После переноса фронтенда на React проверяйте работоспособность `/dashboard`.
- Компоненты Sidebar, Header и DashboardPage берём из шаблона TailAdmin и поддерживаем в каталоге `bot/web`.
- При доработке интерфейса ориентируйтесь на демо https://react-demo.tailadmin.com.
- Стили берутся из репозитория TailAdmin/free-react-tailwind-admin-dashboard, архив удалён из проекта.
- На странице `/dashboard` показывайте актуальные метрики задач, график активности и таблицу последних задач.
- Для примера верстки Dashboard смотрите `docs/dashboard_tailadmin.md`.
- На страницах `Админ`, `Проекты` и `Отчёты` должны присутствовать формы работы с пользователями,
- Инструкции по копированию дизайна TailAdmin в Figma описаны в `docs/tailadmin_figma_design.md`.
  Сам Figma-файл `TailAdminDesign.fig` размещён в каталоге `docs`.
  Файл в репозитории является заглушкой; полный дизайн хранится во внешнем хранилище.
  группами и фильтрами отчётов. Формы отправляют запросы на `/api/users`, `/api/groups`
  и `/api/tasks/report/summary` соответственно.
- `/api/tasks/report/summary` поддерживает параметры `from` и `to` для фильтрации отчёта по дате.
- Контроллер `reportController.js` передаёт эти параметры в агрегат MongoDB.
- Сервер принимает запросы на `/api/groups`, `/api/users`, `/api/roles` и `/api/logs`. Статус задач меняется через `/api/tasks/:id/status`.
- Страницы `Роли` и `Логи` добавлены для управления ролями и просмотра последних записей.
  На странице `Роли` используется форма создания новой роли с запросом на `/api/roles`.
- Дополнительно внедрены компоненты TailAdmin: Dropdown меню профиля, вкладки в разделе профиля и пагинация списка задач.
- На Dashboard, странице профиля и в отчётах отображаются breadcrumbs.
- В Header добавлено выпадающее меню уведомлений.
- Перед запуском убедитесь, что HTML содержит элемент `#root`, иначе React выдаст ошибку 130.
- Если ошибка сохраняется, проверьте наличие свойства `icon` у пунктов меню Sidebar.

Перед созданием PR проверяйте успешное развёртывание на https://railway.com.

- Для работы используйте новый CLI: `npm install -g @railway/cli` и команду `railway status`.
- При ошибке `connect ENETUNREACH` задайте переменные `HTTP_PROXY` и `HTTPS_PROXY` или скачайте архив CLI с GitHub Releases, затем выполните `railway status`.
- Перед релизом создавайте тег `vX.Y.Z` и проверяйте успешное выполнение workflow `release.yml`.
- В `release.yml` после тестов происходит сборка Docker-образа и деплой командой `railway up`.
- Для проверки кода используется базовый workflow `ci.yml`, который устанавливает зависимости и запускает тесты при push в main.
- В нём зависимости бэкенда устанавливаются через `npm ci --prefix bot`. После установки запускайте `npm audit fix --prefix bot`.
- В `docker.yml` файл `.env` создаётся из `.env.example` с подстановкой секретов перед запуском тестов, чтобы избежать ошибок о незаданных переменных окружения.


## Поддержка зависимостей

- Регулярно выполняйте `npm --prefix bot audit` и проверяйте вывод `npm --prefix bot outdated`.
- После установки зависимостей запускайте `npm audit fix --prefix bot` для автоматического устранения найденных уязвимостей и снова проверяйте `npm --prefix bot outdated`.
- Для автоматизации есть скрипт `scripts/audit_dependencies.sh`.
- В качестве примера обновляйте ключевые пакеты, сейчас актуальны `@aws-sdk/client-s3`, `jest` и `@tailwindcss/postcss` версии 4.1.11.
- При появлении предупреждений npm о `lodash.isequal`, `lodash.get`, `inflight` и `glob` обновляйте зависимости до свежих версий.
- Для устранения устаревшего `inflight` проект использует override `glob@11` в `bot/package.json`.
- В `bot/web/package.json` предусмотрены override для `rimraf@6` и `uuid@9`, чтобы убрать устаревшие транзитивные зависимости.
- Зависимости сервера устанавливайте командой `npm ci --prefix bot || npm --prefix bot install`, затем `npm audit fix --prefix bot`.
- В `bot/package.json` снова прописан скрипт `test`; автотесты запускаются через `npm test --prefix bot`.
- Все обращения к MongoDB должны идти через модуль `bot/src/db/queries.js`.
- Для установки используйте скрипт `scripts/install_bot_deps.sh`, который выполняет `npm ci` и затем `npm audit fix`.
- Соединение с базой выполняет `bot/src/db/connection.js`, модели используют его.
- Устаревшие опции `useNewUrlParser` и `useUnifiedTopology` удалены, чтобы
  избежать предупреждений драйвера.
- Для получения одной задачи добавлен маршрут `GET /api/tasks/:id`.
- Перед коммитом проверяйте код командами `npm test --prefix bot`,
  `npx eslint bot/src` и `npm run lint --prefix bot/web`.
- В случае ошибки авторизации мини‑приложение удаляет токен из `localStorage`,
  чтобы исключить повторные 401 при загрузке страниц.
- На странице `/tasks` при ответе 401 или 403 пользователь сразу перенаправляется на `/login`.
- Для корректной работы SPA убраны маршруты `/tasks`; все обращения идут через `/api/tasks`.
- Храним отчёты Lighthouse в каталоге `docs`, примеры: `lighthouse_20250624.md` и `lighthouse_20250626.md`.
- Интерфейс страницы `/roles` стилизован под TailAdmin: форма создания роли и список ролей размещены в карточках с белым фоном и скруглёнными границами.
- Страница `/tasks` получила оформление TailAdmin, таблица и форма теперь используют общие классы и цвета.
- В таблицу задач добавлена кнопка удаления, на сервере реализован `DELETE /api/tasks/:id`.
- Формы проектов и пользователей обновлены по тому же стилю, в `index.css` добавлены утилиты `.btn`, `.btn-blue`, `.btn-gray` и `.btn-green`.
- Исправлены ссылки на workflow Docker и Release в README.
- Подготовлено подробное руководство по TailAdmin: docs/extended_tailadmin_guide.md.
- График `TasksChart` оформлен в корпоративных цветах и реагирует на тёмную тему.
- На Dashboard при загрузке отображаются skeleton-карточки и таблица-заглушка.
- Реализован контекст ToastProvider для отображения нескольких NotificationBar.
- Страницы входа и регистрации приведены к стилю TailAdmin, модальные окна задач плавно появляются.
- Добавлены Breadcrumbs и стили TailAdmin на страницах "Админ", "Проекты" и "Логи".
- Sidebar на десктопе можно свернуть кнопкой в узкий режим.
- Для проверки API и БД создан скрипт `scripts/check_db_fetch.cjs`.
- Для быстрого ping к MongoDB добавлен скрипт `scripts/check_mongo.cjs`.
- Перед упаковкой в Docker обязательно запускайте `node scripts/check_mongo.cjs`. Скрипт работает без установленного `dotenv`, сам считывает `.env` и ищет `mongoose` в `bot/node_modules`.
- При сообщении "bad auth: Authentication failed" скрипт подскажет проверить логин и пароль в `MONGO_DATABASE_URL` и предупредит, если строка подключения не содержит учётных данных.
- При смене строки подключения из Railway запускайте `node scripts/check_mongo.cjs`; при ошибке `ENETUNREACH` проверьте настройки прокси или фаервола.
- Комментарии `/* global fetch */` удалены из исходников, чтобы ESLint не сообщал ошибку `no-redeclare`.

- Пример подключения к MongoDB расположен в `.env.example` и указывает на кластер `arjs-db.4pzoyda.mongodb.net/agromarket`.
- Запросы к задачам вынесены в модуль `bot/web/src/services/tasks.js`.
- В канбане и форме создания теперь используются статусы `new`, `in-progress` и `done`.
- Скрипт `migrate.js` удаляет устаревший индекс `email_1`, регистрация бота не падает при повторном `/register`.
- Полная копия дизайна TailAdmin создана в Figma, инструкция и файл расположены в docs/tailadmin_figma_design.md и docs/TailAdminDesign.fig.
- Обновляйте `bot/web/package-lock.json` после добавления зависимостей, иначе `npm ci` в Dockerfile завершится ошибкой.
- При сообщении `Invalid: lock file's yaml` выполните `npm --prefix bot/web install` и закоммитьте обновлённый lock-файл.
- Если `npm ci` сообщает об отсутствии `package-lock.json`, убедитесь, что файл не повреждён и создан командой `npm --prefix bot/web install`.
- Для всех fetch-запросов используется helper authFetch, который перенаправляет на /login при отсутствии токена.
- Если при сборке Vite появляется предупреждение о размере чанков, внедрите `React.lazy` и настройте `manualChunks` в `vite.config.js`.
- При появлении сообщений `Unexpected ")"` от esbuild проверьте стили. Удалите нестандартные директивы вроде `@custom-variant dark`.
- Обновляйте ключевые пакеты при появлении сообщений об устаревших зависимостях.
  - Проект теперь использует только светлую тему, класс `dark` отключён.
  - Исправлены цвета текста в выпадающих меню и хлебных крошках.
- Цветовая палитра упрощена: удалены `--color-blue-light-*` и `--color-orange-*`,
  добавлены акценты `accentPrimary`, `accentSecondary` и нейтралы `neutral-*`.
  Например, `@aws-sdk/client-s3` повышен до версии 3.837.0, а во фронтенде
  обновлены `@vitejs/plugin-react`, `prettier`, `react-router-dom` и `vite`.
  - Переключатель темы удалён, тёмная тема не поддерживается.
  - В `bot/web/index.html` подключён скрипт `theme.js`, который фиксирует светлую тему.
  - При деплое проверяйте `VITE_BOT_USERNAME`, иначе Telegram Login выдаст ошибку `Username invalid`.
- Пользователям назначаются роли через поле `roleId`, доступ к маршрутам ограничивает middleware `checkRole`.
- После команды `/start` бот отправляет кнопку «Открыть приложение».
  Команда `/app` остаётся опциональной и также проверяет регистрацию.
- При ошибке `BUTTON_TYPE_INVALID` бот повторяет сообщение со ссылкой
  через обычную URL‑кнопку.
- Команда `/browser` выдаёт ссылку с токеном для открытия приложения вне Telegram.
- Команда `/help` выводит краткое описание всех доступных команд.
- Для стабильности добавлены тесты `kanbanStatus` и `authRole`.
- Регистрация в веб-интерфейсе отключена, новые пользователи создаются ботом при наличии в Telegram-группе из `.env`.
  - Добавлена страница `/login` с Telegram Login. Сервер проверяет подпись данных и
    выдаёт JWT для входа в мини‑приложение.
  - В `helmet` добавлены директивы `script-src https://telegram.org 'unsafe-eval'` и `media-src data:`, чтобы виджет Telegram работал без ошибок CSP.
- Для аутентификации используется виджет Telegram версии 22 с параметром `data-request-access="write"`.
- Добавлен функционал отделов: задачи и пользователи привязываются к отделу.
- Команда `/create_task` теперь передаёт поле `title` и приоритет "В течении дня", что устранило ошибку валидации при деплое.
- Если текст после команды отсутствует, бот напоминает указать название, иначе задача не создаётся.
- Команда `/list_tasks` выдаёт «Нет задач», если список пуст, чтобы избежать ошибки Telegram.
- Команды `/list_tasks` и `/list_all_tasks` отправляют список с кнопками "✔️" и "❌" для завершения и удаления задач.
- Команда `/task_menu` открывает inline-меню с кнопками "Мои задачи", "Все задачи" и "Открыть приложение".
- Линтер фронтенда использует `@typescript-eslint/parser` и одноимённый плагин, маска файлов `**/*.{js,jsx,ts,tsx}`.
- Компонент `Admin` описан на TypeScript и подключает контекст авторизации через `import { AuthContext }`.
- Остальные компоненты фронтенда также переведены на `.tsx`, файлов `.jsx` не осталось.

- Команды `/assign_task`, `/upload_file` и `/edit_last` проверяют обязательные аргументы перед обращением к API.
- `/assign_task` при указании только id задачи отправляет кнопку `KeyboardButton.requestUser`, админ выбирает исполнителя из контактов. Для выбора группы используется `KeyboardButton.requestChat`.
- `/upload_file` принимает документ или фото и сохраняет ссылку в задаче.
- `/upload_voice` принимает голосовое сообщение и также сохраняет ссылку в задаче.
- Добавлены тесты `commandValidation` для этих команд.
- В inline-режиме появились команды `add` и `search` для создания и поиска задач.
- В `docs/telegram_bot_manual.md` появился раздел «Типовые ошибки API» с примером `Bad Request: message text is empty`.

- Планировщик `scheduler.js` раз в минуту проверяет задачи с полем `remind_at` и отправляет уведомление. Запускается он только вне режима test, остановить можно функцией `stopScheduler()`.
- Сообщение рассылается каждому пользователю из полей `assigned_user_id` или `assignees`, учитывая настройку `receive_reminders` в коллекции `telegram_users`. Если исполнители не указаны, уведомление отправляется в чат отдела.
- Для отправки сообщений планировщик использует очередь `p-queue` с лимитом 30 запросов в секунду.

- Поддержаны deep links `/start=task_<id>` и `/start=invite_<departmentId>`.

- Для установки TDLib используйте скрипт `scripts/setup_tdweb.sh`, который ставит пакет `tdweb` и копирует файлы в `bot/web/public/tdlib`.
- Страница `/chats` отображает чаты через TDLib. После установки скриптом `setup_tdweb.sh` убедитесь, что директория `bot/web/public/tdlib` содержит файлы.
- В шапке отображается ссылка "Войти" при отсутствии токена, иначе выпадающее меню профиля.
- После создания задачи Web App отправляет `sendData('task_created:<id>')`, бот
  реагирует на `web_app_data` и подтверждает создание.
- В обработчике `/create_task` бот после сохранения вызывает `createForumTopic` и
  сохраняет идентификатор в поле `telegram_topic_id`; ссылка на тему отображается
  в интерфейсе задачи.
- В начало документации и README добавлены комментарии с назначением файлов, чтобы упростить навигацию.
- Для корректной работы CLI добавлены опции `moduleResolution: node` и `types: ['node']`.
- `.env.example` дополнен комментариями и содержит все переменные из `bot/src/config.js`.
- В комментариях к каждой переменной указано её назначение и источник значения.
- В README указан контроль схем `APP_URL` и `MONGO_DATABASE_URL`.
- На страницах задач и в админ‑панели ссылки `tg://user?id=<telegram_id>` позволяют открыть чат с исполнителем.
- Модуль `gateway.js` отправляет SMS через HTTPS, в `authController` доступна опция замены SMS на Telegram.
- В `authController` код подтверждения хранится с меткой времени и удаляется через 5 минут.
- При наличии переменной `BOT_API_URL` запросы к Bot API направляются на этот адрес, что позволяет использовать локальный сервер и загружать файлы объёмом до 2 ГБ.
- Перед сборкой Docker проверяйте lock-файл `bot/web/package-lock.json`, иначе `npm ci` завершится ошибкой.
- В коде config.js проверяются стандартные `ADMIN_EMAIL` и `ADMIN_PASSWORD`; в продакшене их следует заменить.
- README дополнен оглавлением и кратким списком возможностей. Добавлен пример API-запроса.
- Переменные VITE_TELEGRAM_API_ID и VITE_TELEGRAM_API_HASH не используются, но приведены в примере для будущих обновлений.
- В тестах переменные окружения устанавливаются в начале файлов, иначе `config.js` завершит выполнение ошибкой `Переменная BOT_TOKEN не задана`.
- API перед запуском проверяет наличие `bot/public/index.html`; если файл отсутствует
  или пустой, запускается `npm run build-client`.

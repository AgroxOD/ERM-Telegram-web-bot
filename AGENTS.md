<!-- Назначение файла: правила использования Codex. -->
# Инструкции для Codex

## Стиль
- Все комментарии и документацию пишите на русском языке.
- Код должен быть лаконичным и эффективным, избегайте избыточности.
- В начале каждого файла размещайте краткое описание его назначения и основных модулей.

## Тесты
В проекте пока нет автоматических тестов. После изменений достаточно убедиться, что проект собирается без ошибок.

## Проверка Docker Compose
Если присутствует `docker-compose.yml`, перед коммитом можно выполнить:
```bash
docker compose config
```
Эта команда проверит корректность файла.
Перед запуском убедитесь, что создан `.env`, иначе появится ошибка о его отсутствии.
При необходимости сформируйте `.env` из экспортированных переменных скриптом
`./scripts/create_env_from_exports.sh`. Скрипт создаёт файл только если его нет,
используя значения из текущего окружения либо данные из `.env.example`.

## Деплой
Перед развёртыванием убедитесь, что статический фронтенд собран командой
`npm --prefix bot run build-client` или через `Procfile`.
 - Если в логах встречается `GET /dashboard/` со статусом `404`, запустите `npm --prefix bot run build-client` и убедитесь, что каталог `bot/public` заполнен.
- Если сборка завершается ошибкой `next: not found`, сначала выполните `npm --prefix bot/client install`.
- После обновления зависимостей повторяйте `npm --prefix bot/client install` и затем `npm --prefix bot run build-client`.
- Для поиска ошибок сохраняйте вывод в лог:
  ```bash
  npm --prefix bot/client install > /tmp/npm_install.log 2>&1 && tail -n 20 /tmp/npm_install.log
  npm --prefix bot run build-client > /tmp/npm_build.log 2>&1 && tail -n 20 /tmp/npm_build.log
  ```
- При ошибках сети, связанных с доменом `nextjs.org`, проверьте настройки доступа или используйте прокси.
